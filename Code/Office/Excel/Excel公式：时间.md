# Excel 时间相关公式

### 将数值转化为“时分秒”的形式

[1]: https://www.office68.com/excel/2008.html

由于Excel中时间是以小数的形式表示的，例如`12:00:00`（12时整）对应值`0.5`，因此对原数值做除法再选用特定的格式即可转换成“时分秒”的形式。

#### 小时数 -> 时分秒

单元格格式设置为`[h]小时mm分钟ss秒`

```
=A1/24
```

例：`33.255` -> `33小时15分钟18秒`

#### 分钟数 -> 时分秒

单元格格式设置为`[h]小时mm分钟ss秒`

```
=A1/1440
```

例：`75.5` -> `1小时15分钟30秒`

#### 格式说明

自定义格式和公式中的`[h]`可以让Excel返回超过24小时的时间；同理`[m]`表示返回超过60分钟的时间。

如果不想对单元格格式进行配置可以直接在公式指定格式：

```
=TEXT(A1/1440,"[m]分钟ss秒")
```



### 将UNIX Timestamp（时间戳）转换为“时分秒”的形式

Excel公式：

```
=(A1/86400) + DATE(1970,1,1)
```

单元格格式设置为`yyyy/mm/dd hh:mm:ss`

注意，上述转换的时间为UTC，对于特定时区需要手动修改。比如北京时间（UTC +8:00，东八区）要在上述的基础上加`TIME(8,0,0)`

```
=(A1/86400) + DATE(1970,1,1) + TIME(8,0,0)
```

#### 毫秒时间戳（milliseconds timestamp）处理

对于毫秒时间戳，要将除以`86400`改为`86400,000`

```
=(A1/86400000) + DATE(1970,1,1) + TIME(8,0,0)
```

如果要将毫秒以小数的形式在“时分秒”中显示出来，在`ss`后面加`.000`

单元格格式设置为`yyyy/mm/dd hh:mm:ss.000`